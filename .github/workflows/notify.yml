- name: Envoie notif Discord
  if: steps.check.outputs.active == 'true'
  env:
    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  run: |
    REPO_URL="https://github.com/${{ github.repository }}"
    TRIGGER_URL="$REPO_URL/actions/workflows/restart.yml"
    
    DESCRIPTION="Il est temps de farmer tes cartes, Senpai ! âœ¨\nClique sur le bouton ci-dessous pour relancer le timer. ðŸ’•"
    
    curl -H "Content-Type: application/json" \
         -d "$(jq -n \
         --arg title 'ðŸŒ¸ Karuta Timer' \
         --arg desc "$DESCRIPTION" \
         --arg url "$TRIGGER_URL" \
         --arg image 'https://media.tenor.com/kC3K9nbhF8IAAAAi/anime-girl.gif' \
         --arg footer 'Powered by GitHub Actions â€¢ Made with ðŸ’– by Spincka' \
         '{
           "embeds": [
             {
               "title": $title,
               "description": $desc,
               "color": 15548997,
               "url": $url,
               "image": {"url": $image},
               "footer": {"text": $footer}
             }
           ],
           "components": [
             {
               "type": 1,
               "components": [
                 {
                   "type": 2,
                   "style": 5,
                   "label": "ðŸ’« Relancer le timer",
                   "url": $url
                 }
               ]
             }
           ]
         }')" \
         ${{ secrets.DISCORD_WEBHOOK_URL }}
